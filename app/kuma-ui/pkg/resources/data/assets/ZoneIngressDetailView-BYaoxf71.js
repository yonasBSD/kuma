import{d as H,a1 as J,r as u,p as y,o as a,w as t,b as s,e as n,q as w,l as o,c as p,t as i,S as K,L as f,M as v,m as A,a2 as Q,y as U,_ as W}from"./index-B8sBWiVp.js";import{C as B,b as q,a as Y}from"./ConnectionTraffic-DuyHsajw.js";import"./TagList-CXKiZ7or.js";const h={key:0},ee={key:0},te=H({__name:"ZoneIngressDetailView",props:{data:{}},setup(L){const r=L,D=J();return(ne,e)=>{const k=u("XBadge"),V=u("XCopyButton"),b=u("XLayout"),S=u("XDl"),C=u("XAction"),R=u("XI18n"),$=u("XAboutCard"),I=u("DataCollection"),N=u("XInputSwitch"),O=u("XCard"),j=u("XDrawer"),Z=u("RouterView"),E=u("DataLoader"),F=u("AppView"),G=u("RouteView");return a(),y(G,{name:"zone-ingress-detail-view",params:{subscription:"",proxy:"",inactive:Boolean}},{default:t(({t:l,route:c,uri:M})=>[s(F,null,{default:t(()=>[s($,{title:l("zone-ingresses.routes.item.about.title"),created:r.data.creationTime,modified:r.data.modificationTime,class:"about-section","data-testid":"zone-ingress-about-section"},{default:t(()=>[s(b,null,{default:t(()=>[s(S,{variant:"x-stack"},{default:t(()=>[o("div",null,[o("dt",null,i(l("http.api.property.status")),1),e[0]||(e[0]=n()),o("dd",null,[s(K,{status:r.data.state},null,8,["status"])])]),e[5]||(e[5]=n()),r.data.namespace.length>0?(a(),p("div",h,[o("dt",null,i(l("http.api.property.namespace")),1),e[1]||(e[1]=n()),o("dd",null,[s(k,{appearance:"decorative"},{default:t(()=>[n(i(r.data.namespace),1)]),_:1})])])):w("",!0),e[6]||(e[6]=n()),o("div",null,[o("dt",null,i(l("http.api.property.address")),1),e[2]||(e[2]=n()),o("dd",null,[r.data.zoneIngress.socketAddress.length>0?(a(),y(V,{key:0,variant:"badge",format:"default",text:r.data.zoneIngress.socketAddress},null,8,["text"])):(a(),p(f,{key:1},[n(i(l("common.detail.none")),1)],64))])]),e[7]||(e[7]=n()),o("div",null,[o("dt",null,i(l("http.api.property.advertisedAddress")),1),e[3]||(e[3]=n()),o("dd",null,[r.data.zoneIngress.advertisedSocketAddress.length>0?(a(),y(k,{key:0,appearance:"decorative"},{default:t(()=>[s(V,{text:r.data.zoneIngress.advertisedSocketAddress},null,8,["text"])]),_:1})):(a(),p(f,{key:1},[n(i(l("common.detail.none")),1)],64))])]),e[8]||(e[8]=n()),(a(!0),p(f,null,v([Object.entries(r.data.labels)],m=>(a(),p(f,{key:typeof m},[m.length>0?(a(),p("div",ee,[o("dt",null,i(l("services.routes.item.labels")),1),e[4]||(e[4]=n()),o("dd",null,[s(b,{variant:"separated",truncate:""},{default:t(()=>[(a(),p(f,null,v([/^(.+\.)?kuma\.io\//],x=>(a(),p(f,{key:typeof x},[(a(!0),p(f,null,v(m,([d,_])=>(a(),y(k,{key:d,appearance:x.test(d)?"info":"decorative"},{default:t(()=>[n(i(d)+":"+i(_),1)]),_:2},1032,["appearance"]))),128))],64))),64))]),_:2},1024)])])):w("",!0)],64))),128))]),_:2},1024),e[16]||(e[16]=n()),r.data.zoneIngressInsight.subscriptions.length>0?(a(),y(b,{key:0,"data-testid":"about-zone-ingress-subscriptions",class:"about-subsection"},{default:t(()=>[s(b,{type:"separated"},{default:t(()=>[o("h3",null,i(l("zone-ingresses.routes.item.subscriptions.title")),1),e[9]||(e[9]=n()),s(C,{"data-action":"",appearance:"anchor",to:{name:"zone-ingress-subscriptions-list-view",params:{proxy:c.params.proxy},query:{inactive:c.params.inactive}}},{default:t(()=>[n(`
                (`+i(l("zone-ingresses.routes.item.subscriptions.show-details"))+`)
              `,1)]),_:2},1032,["to"])]),_:2},1024),e[15]||(e[15]=n()),(a(!0),p(f,null,v([r.data.zoneIngressInsight.connectedSubscription],m=>(a(),p(f,{key:typeof m},[!m?.disconnectTime&&m?.connectTime?(a(),y(S,{key:0,variant:"x-stack"},{default:t(()=>[o("div",null,[o("dt",null,i(l("zone-ingresses.routes.item.subscriptions.connected")),1),e[10]||(e[10]=n()),o("dd",null,[s(k,{appearance:"neutral"},{default:t(()=>[n(i(l("common.formats.datetime",{value:Date.parse(m.connectTime)})),1)]),_:2},1024)])]),e[13]||(e[13]=n()),o("div",null,[o("dt",null,i(l("zone-ingresses.routes.item.subscriptions.instance")),1),e[11]||(e[11]=n()),o("dd",null,[s(k,{appearance:"info"},{default:t(()=>[n(i(m.controlPlaneInstanceId),1)]),_:2},1024)])]),e[14]||(e[14]=n()),o("div",null,[o("dt",null,i(l("zone-ingresses.routes.item.subscriptions.version")),1),e[12]||(e[12]=n()),o("dd",null,[s(k,{appearance:"info"},{default:t(()=>[n(i(m.version?.kumaDp?.version??l("common.unknown")),1)]),_:2},1024)])])]),_:2},1024)):(a(),y(R,{key:1,path:"zone-ingresses.routes.item.subscriptions.disconnected"}))],64))),128))]),_:2},1024)):w("",!0)]),_:2},1024)]),_:2},1032,["title","created","modified"]),e[23]||(e[23]=n()),s(E,{src:M(A(Q),"/connections/stats/for/:proxyType/:name/:mesh/:socketAddress",{name:c.params.proxy,mesh:"*",socketAddress:r.data.zoneIngress.socketAddress,proxyType:"zone-ingress"})},{default:t(({data:[m],refresh:x})=>[s(O,null,{default:t(()=>[s(b,{type:"columns"},{default:t(()=>[s(B,null,{default:t(()=>[s(b,{type:"stack",size:"small"},{default:t(()=>[s(I,{type:"inbounds",items:Object.entries(m.inbounds)},{default:t(({items:d})=>[(a(!0),p(f,null,v(d,([_,z])=>(a(),y(q,{key:`${_}`,protocol:"",traffic:z},{default:t(()=>[s(C,{"data-action":"",to:{name:(g=>g.includes("bound")?g.replace("-outbound-","-inbound-"):"zone-ingress-connection-inbound-summary-stats-view")(String(A(D).name)),params:{connection:_,proxyType:"ingresses"},query:{inactive:c.params.inactive}}},{default:t(()=>[n(`
                        :`+i(_.split("_").at(-1)),1)]),_:2},1032,["to"])]),_:2},1032,["traffic"]))),128))]),_:2},1032,["items"])]),_:2},1024)]),_:2},1024),e[21]||(e[21]=n()),s(B,null,{actions:t(()=>[s(N,{checked:c.params.inactive,"data-testid":"dataplane-outbounds-inactive-toggle",onChange:d=>c.update({inactive:d})},{label:t(()=>[...e[17]||(e[17]=[n(`
                    Show inactive
                  `,-1)])]),_:1},8,["checked","onChange"]),e[19]||(e[19]=n()),s(C,{action:"refresh",appearance:"primary",onClick:x},{default:t(()=>[...e[18]||(e[18]=[n(`
                  Refresh
                `,-1)])]),_:1},8,["onClick"])]),default:t(()=>[e[20]||(e[20]=n()),(a(),p(f,null,v(["upstream"],d=>s(I,{key:d,type:"outbounds",items:Object.entries(m.outbounds)},{default:t(({items:_})=>[s(I,{type:"activeOutbounds",predicate:c.params.inactive?void 0:([z,g])=>((typeof g.tcp<"u"?g.tcp?.[`${d}_cx_rx_bytes_total`]:g.http?.[`${d}_rq_total`])??0)>0,items:_},{default:t(({items:z})=>[z.length>0?(a(),y(Y,{key:0,type:"outbound"},{default:t(()=>[(a(),p(f,null,v([/-([a-f0-9]){16}$/],g=>s(b,{key:typeof g,type:"stack",size:"small"},{default:t(()=>[(a(!0),p(f,null,v(z,([X,P])=>(a(),y(q,{key:`${X}`,"data-testid":"dataplane-outbound",protocol:"",traffic:P,direction:d},{default:t(()=>[s(C,{"data-action":"",to:{name:(T=>T.includes("bound")?T.replace("-inbound-","-outbound-"):"zone-ingress-connection-outbound-summary-stats-view")(String(A(D).name)),params:{connection:X},query:{inactive:c.params.inactive}}},{default:t(()=>[n(i(X),1)]),_:2},1032,["to"])]),_:2},1032,["traffic","direction"]))),128))]),_:2},1024)),64))]),_:2},1024)):w("",!0)]),_:2},1032,["predicate","items"])]),_:2},1032,["items"])),64))]),_:2},1024)]),_:2},1024)]),_:2},1024),e[22]||(e[22]=n()),s(Z,null,{default:t(d=>[d.route.name!==c.name?(a(),y(j,{key:0,width:"670px",onClose:function(){c.replace({name:"zone-ingress-detail-view",params:{proxy:c.params.proxy,proxyType:"ingresses"},query:{inactive:c.params.inactive?null:void 0}})}},{default:t(()=>[(a(),y(U(d.Component),{data:c.params.subscription.length>0?r.data.zoneIngressInsight.subscriptions:d.route.name.includes("-inbound-")?[r.data.zoneIngress]:m?.outbounds||{},networking:r.data.zoneIngress.networking},null,8,["data","networking"]))]),_:2},1032,["onClose"])):w("",!0)]),_:2},1024)]),_:2},1032,["src"])]),_:2},1024)]),_:1})}}}),ie=W(te,[["__scopeId","data-v-e8718e9a"]]);export{ie as default};
