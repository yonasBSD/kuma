import{d as H,a1 as J,r as d,p as y,o as a,w as t,b as o,e as n,q as z,l as s,c as p,t as r,S as K,L as f,M as b,m as V,a2 as Q,y as U,_ as W}from"./index-CNBZ1Xyr.js";import{C as I,b as T,a as Y}from"./ConnectionTraffic-CQniVWsB.js";import"./TagList-DDdplo0v.js";const h={key:0},ee={key:0},te=H({__name:"ZoneEgressDetailView",props:{data:{}},setup(S){const u=S,A=J();return(ne,e)=>{const k=d("XBadge"),L=d("XCopyButton"),g=d("XLayout"),E=d("XDl"),C=d("XAction"),q=d("XI18n"),R=d("XAboutCard"),X=d("DataCollection"),$=d("XInputSwitch"),N=d("XCard"),O=d("XDrawer"),j=d("RouterView"),Z=d("DataLoader"),F=d("AppView"),G=d("RouteView");return a(),y(G,{name:"zone-egress-detail-view",params:{inactive:Boolean,subscription:"",proxy:""}},{default:t(({t:m,route:c,uri:M})=>[o(F,null,{default:t(()=>[o(g,{type:"stack"},{default:t(()=>[o(R,{title:m("zone-egresses.routes.item.about.title"),created:u.data.creationTime,modified:u.data.modificationTime,class:"about-section","data-testid":"zone-egress-about-section"},{default:t(()=>[o(g,null,{default:t(()=>[o(E,{variant:"x-stack"},{default:t(()=>[s("div",null,[s("dt",null,r(m("http.api.property.status")),1),e[0]||(e[0]=n()),s("dd",null,[o(K,{status:u.data.state},null,8,["status"])])]),e[4]||(e[4]=n()),u.data.namespace.length>0?(a(),p("div",h,[s("dt",null,r(m("http.api.property.namespace")),1),e[1]||(e[1]=n()),s("dd",null,[o(k,{appearance:"decorative"},{default:t(()=>[n(r(u.data.namespace),1)]),_:1})])])):z("",!0),e[5]||(e[5]=n()),s("div",null,[s("dt",null,r(m("http.api.property.address")),1),e[2]||(e[2]=n()),s("dd",null,[u.data.zoneEgress.socketAddress.length>0?(a(),y(L,{key:0,variant:"badge",format:"default",text:u.data.zoneEgress.socketAddress},null,8,["text"])):(a(),p(f,{key:1},[n(r(m("common.detail.none")),1)],64))])]),e[6]||(e[6]=n()),(a(!0),p(f,null,b([Object.entries(u.data.labels)],l=>(a(),p(f,{key:typeof l},[l.length>0?(a(),p("div",ee,[s("dt",null,r(m("services.routes.item.labels")),1),e[3]||(e[3]=n()),s("dd",null,[o(g,{variant:"separated",truncate:""},{default:t(()=>[(a(),p(f,null,b([/^(.+\.)?kuma\.io\//],x=>(a(),p(f,{key:typeof x},[(a(!0),p(f,null,b(l,([i,v])=>(a(),y(k,{key:i,appearance:x.test(i)?"info":"decorative"},{default:t(()=>[n(r(i)+":"+r(v),1)]),_:2},1032,["appearance"]))),128))],64))),64))]),_:2},1024)])])):z("",!0)],64))),128))]),_:2},1024),e[14]||(e[14]=n()),u.data.zoneEgressInsight.subscriptions.length>0?(a(),y(g,{key:0,"data-testid":"about-zone-egress-subscriptions",class:"about-subsection"},{default:t(()=>[o(g,{type:"separated"},{default:t(()=>[s("h3",null,r(m("zone-egresses.routes.item.subscriptions.title")),1),e[7]||(e[7]=n()),o(C,{"data-action":"",appearance:"anchor",to:{name:"zone-egress-subscriptions-list-view",params:{proxy:c.params.proxy},query:{inactive:c.params.inactive}}},{default:t(()=>[n(`
                  (`+r(m("zone-egresses.routes.item.subscriptions.show-details"))+`)
                `,1)]),_:2},1032,["to"])]),_:2},1024),e[13]||(e[13]=n()),(a(!0),p(f,null,b([u.data.zoneEgressInsight.connectedSubscription],l=>(a(),p(f,{key:typeof l},[!l?.disconnectTime&&l?.connectTime?(a(),y(E,{key:0,variant:"x-stack"},{default:t(()=>[s("div",null,[s("dt",null,r(m("zone-egresses.routes.item.subscriptions.connected")),1),e[8]||(e[8]=n()),s("dd",null,[o(k,{appearance:"neutral"},{default:t(()=>[n(r(m("common.formats.datetime",{value:Date.parse(l.connectTime)})),1)]),_:2},1024)])]),e[11]||(e[11]=n()),s("div",null,[s("dt",null,r(m("zone-egresses.routes.item.subscriptions.instance")),1),e[9]||(e[9]=n()),s("dd",null,[o(k,{appearance:"info"},{default:t(()=>[n(r(l.controlPlaneInstanceId),1)]),_:2},1024)])]),e[12]||(e[12]=n()),s("div",null,[s("dt",null,r(m("zone-egresses.routes.item.subscriptions.version")),1),e[10]||(e[10]=n()),s("dd",null,[o(k,{appearance:"info"},{default:t(()=>[n(r(l.version?.kumaDp?.version??m("common.unknown")),1)]),_:2},1024)])])]),_:2},1024)):(a(),y(q,{key:1,path:"zone-egresses.routes.item.subscriptions.disconnected"}))],64))),128))]),_:2},1024)):z("",!0)]),_:2},1024)]),_:2},1032,["title","created","modified"]),e[21]||(e[21]=n()),o(Z,{src:M(V(Q),"/connections/stats/for/:proxyType/:name/:mesh/:socketAddress",{name:c.params.proxy,mesh:"*",socketAddress:u.data.zoneEgress.socketAddress,proxyType:"zone-egress"})},{default:t(({data:l,refresh:x})=>[o(N,null,{default:t(()=>[o(g,{type:"columns"},{default:t(()=>[o(I,null,{default:t(()=>[o(g,{type:"stack",size:"small"},{default:t(()=>[o(X,{type:"inbounds",items:Object.entries(l.inbounds)},{default:t(({items:i})=>[(a(!0),p(f,null,b(i,([v,w])=>(a(),y(T,{key:`${v}`,protocol:"",traffic:w},{default:t(()=>[o(C,{"data-action":"",to:{name:(_=>_.includes("bound")?_.replace("-outbound-","-inbound-"):"zone-egress-connection-inbound-summary-stats-view")(String(V(A).name)),params:{connection:v},query:{inactive:c.params.inactive}}},{default:t(()=>[n(`
                          :`+r(v.split("_").at(-1)),1)]),_:2},1032,["to"])]),_:2},1032,["traffic"]))),128))]),_:2},1032,["items"])]),_:2},1024)]),_:2},1024),e[19]||(e[19]=n()),o(I,null,{actions:t(()=>[o($,{checked:c.params.inactive,"data-testid":"dataplane-outbounds-inactive-toggle",onChange:i=>c.update({inactive:i})},{label:t(()=>[...e[15]||(e[15]=[n(`
                      Show inactive
                    `,-1)])]),_:1},8,["checked","onChange"]),e[17]||(e[17]=n()),o(C,{action:"refresh",appearance:"primary",onClick:x},{default:t(()=>[...e[16]||(e[16]=[n(`
                    Refresh
                  `,-1)])]),_:1},8,["onClick"])]),default:t(()=>[e[18]||(e[18]=n()),(a(),p(f,null,b(["upstream"],i=>o(X,{key:i,type:"outbounds",items:Object.entries(l.outbounds)},{default:t(({items:v})=>[o(X,{type:"activeOutbounds",predicate:c.params.inactive?void 0:([w,_])=>((typeof _.tcp<"u"?_.tcp?.[`${i}_cx_rx_bytes_total`]:_.http?.[`${i}_rq_total`])??0)>0,items:v},{default:t(({items:w})=>[w.length>0?(a(),y(Y,{key:0,type:"outbound"},{default:t(()=>[(a(),p(f,null,b([/-([a-f0-9]){16}$/],_=>o(g,{key:typeof _,type:"stack",size:"small"},{default:t(()=>[(a(!0),p(f,null,b(w,([D,P])=>(a(),y(T,{key:`${D}`,"data-testid":"dataplane-outbound",protocol:"",traffic:P,direction:i},{default:t(()=>[o(C,{"data-action":"",to:{name:(B=>B.includes("bound")?B.replace("-inbound-","-outbound-"):"zone-egress-connection-outbound-summary-stats-view")(String(V(A).name)),params:{connection:D},query:{inactive:c.params.inactive}}},{default:t(()=>[n(r(D),1)]),_:2},1032,["to"])]),_:2},1032,["traffic","direction"]))),128))]),_:2},1024)),64))]),_:2},1024)):z("",!0)]),_:2},1032,["predicate","items"])]),_:2},1032,["items"])),64))]),_:2},1024)]),_:2},1024)]),_:2},1024),e[20]||(e[20]=n()),o(j,null,{default:t(i=>[i.route.name!==c.name?(a(),y(O,{key:0,width:"670px",onClose:function(){c.replace({name:"zone-egress-detail-view",params:{proxyType:"egresses",proxy:c.params.proxy}})}},{default:t(()=>[(a(),y(U(i.Component),{data:c.params.subscription.length>0?u.data.zoneEgressInsight.subscriptions:i.route.name.includes("-inbound-")?[u.data.zoneEgress]:l?.outbounds||{},networking:u.data.zoneEgress.networking},null,8,["data","networking"]))]),_:2},1032,["onClose"])):z("",!0)]),_:2},1024)]),_:2},1032,["src"])]),_:2},1024)]),_:2},1024)]),_:1})}}}),re=W(te,[["__scopeId","data-v-65b0829a"]]);export{re as default};
