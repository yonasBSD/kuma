import{d as K,r as m,p as _,o as n,w as a,b as i,e as o,m as C,a8 as D,q as w,l as u,c as p,t as s,L as c,M as v,a as Z,I as F,Z as O,K as H,y as J,_ as Q}from"./index-CNBZ1Xyr.js";const U={key:0},Y={key:1},P={key:0},ee=["data-testid"],ae=K({__name:"WorkloadDetailView",props:{data:{}},setup($){const l=$;return(V,t)=>{const S=m("RouteTitle"),z=m("XBadge"),b=m("XAction"),X=m("XLayout"),A=m("XDl"),x=m("DataLoader"),L=m("XAboutCard"),T=m("XSearch"),E=m("XIcon"),I=m("XActionGroup"),N=m("XDrawer"),R=m("RouterView"),B=m("DataCollection"),M=m("XCard"),W=m("AppView"),j=m("RouteView");return n(),_(j,{name:"workload-detail-view",params:{mesh:"",wl:"",page:1,size:Number,proxy:"",s:""}},{default:a(({route:r,t:d,uri:q,me:g,can:G})=>[i(S,{render:!1,title:d("workloads.routes.item.title",{name:C(D).fromString(r.params.wl).name})},null,8,["title"]),t[18]||(t[18]=o()),i(W,null,{default:a(()=>[i(L,{title:d("workloads.routes.item.about.title"),created:typeof l.data<"u"&&!(l.data instanceof Error)?l.data.creationTime:void 0,modified:typeof l.data<"u"&&!(l.data instanceof Error)?l.data.modificationTime:void 0,"data-testid":"about-workload"},{default:a(()=>[i(x,{data:[l.data]},{default:a(()=>[typeof l.data<"u"&&!(l.data instanceof Error)?(n(),_(A,{key:0},{default:a(()=>[u("div",null,[u("dt",null,s(d("http.api.property.status")),1),t[1]||(t[1]=o()),u("dd",null,[i(z,{appearance:d(`common.status.appearance.${l.data.status.state}`,void 0,{defaultMessage:"neutral"})},{default:a(()=>[o(s(d(`http.api.value.${l.data.status.state}`)),1)]),_:2},1032,["appearance"])])]),t[5]||(t[5]=o()),l.data.zone.length?(n(),p("div",U,[u("dt",null,s(d("http.api.property.zone")),1),t[2]||(t[2]=o()),u("dd",null,[l.data.zone?(n(),_(b,{key:0,to:{name:"zone-cp-detail-view",params:{zone:l.data.zone}}},{default:a(()=>[i(z,null,{default:a(()=>[o(s(l.data.zone),1)]),_:1})]),_:1},8,["to"])):w("",!0)])])):w("",!0),t[6]||(t[6]=o()),l.data.namespace.length?(n(),p("div",Y,[u("dt",null,s(d("http.api.property.namespace")),1),t[3]||(t[3]=o()),u("dd",null,[i(z,null,{default:a(()=>[o(s(l.data.namespace),1)]),_:1})])])):w("",!0),t[7]||(t[7]=o()),(n(!0),p(c,null,v([Object.entries(l.data.labels)],y=>(n(),p(c,{key:typeof y},[y.length>0?(n(),p("div",P,[u("dt",null,s(d("workloads.routes.item.about.labels")),1),t[4]||(t[4]=o()),u("dd",null,[i(X,{variant:"separated",truncate:""},{default:a(()=>[(n(),p(c,null,v([/^(.+\.)?kuma\.io\//],f=>(n(),p(c,{key:typeof f},[(n(!0),p(c,null,v(y,([e,k])=>(n(),_(z,{key:e,appearance:f.test(e)?"info":"decorative"},{default:a(()=>[o(s(e)+":"+s(k),1)]),_:2},1032,["appearance"]))),128))],64))),64))]),_:2},1024)])])):w("",!0)],64))),128))]),_:2},1024)):w("",!0)]),_:2},1032,["data"])]),_:2},1032,["title","created","modified"]),t[17]||(t[17]=o()),i(M,null,{default:a(()=>[i(X,{variant:"y-stack"},{default:a(()=>[Z(V.$slots,"title",{},()=>[u("h2",null,s(d("workloads.routes.item.dataplaneProxies.title")),1)],!0),t[15]||(t[15]=o()),u("search",null,[u("form",{class:"search-form",onSubmit:t[0]||(t[0]=F(()=>{},["prevent"]))},[i(T,{class:"search-field",keys:["name","tag","label"],value:r.params.s,onChange:y=>r.update({page:1,s:y})},null,8,["value","onChange"])],32)]),t[16]||(t[16]=o()),(n(!0),p(c,null,v([C(D).fromString(r.params.wl)],y=>(n(),_(x,{key:typeof y,src:q(C(O),"/meshes/:mesh/dataplanes/of/:type",{mesh:r.params.mesh,type:"standard"},{page:r.params.page,size:r.params.size,search:`${r.params.s} kuma.io/workload:${y.name} ${[["namespace",y.namespace],["zone",y.zone]].filter(([,f])=>f.length>0).map(([f,e])=>`${f}:${e}`).join(" ")}`}),variant:"list"},{default:a(({data:f})=>[i(B,{items:f.items,total:f.total,page:r.params.page,"page-size":r.params.size,onChange:r.update},{default:a(()=>[i(H,{class:"data-plane-collection","data-testid":"data-plane-collection",headers:[{...g.get("headers.name"),label:"Name",key:"name"},{...g.get("headers.namespace"),label:"Namespace",key:"namespace"},...G("use zones")?[{...g.get("headers.zone"),label:"Zone",key:"zone"}]:[],{...g.get("headers.certificate"),label:"Certificate info",key:"certificate"},{...g.get("headers.status"),label:"Status",key:"status"},{...g.get("headers.warnings"),label:"Warnings",key:"warnings",hideLabel:!0},{...g.get("headers.actions"),label:"Actions",key:"actions",hideLabel:!0}],items:f.items,onResize:g.set},{name:a(({row:e})=>[i(b,{"data-action":"",class:"name-link",title:e.name,to:{name:"workload-data-plane-summary-view",params:{mesh:e.mesh,proxy:e.id}}},{default:a(()=>[o(s(e.name),1)]),_:2},1032,["title","to"])]),namespace:a(({row:e})=>[o(s(e.namespace),1)]),zone:a(({row:e})=>[e.zone?(n(),_(b,{key:0,to:{name:"zone-cp-detail-view",params:{zone:e.zone}}},{default:a(()=>[o(s(e.zone),1)]),_:2},1032,["to"])):(n(),p(c,{key:1},[o(s(d("common.collection.none")),1)],64))]),certificate:a(({row:e})=>[e.dataplaneInsight.mTLS?.certificateExpirationTime?(n(),p(c,{key:0},[o(s(d("common.formats.datetime",{value:Date.parse(e.dataplaneInsight.mTLS.certificateExpirationTime)})),1)],64)):(n(),p(c,{key:1},[o(s(d("data-planes.components.data-plane-list.certificate.none")),1)],64))]),status:a(({row:e})=>[i(z,{appearance:d(`common.status.appearance.${e.status}`,void 0,{defaultMessage:"neutral"})},{default:a(()=>[o(s(d(`http.api.value.${e.status}`)),1)]),_:2},1032,["appearance"])]),warnings:a(({row:e})=>[(n(!0),p(c,null,v([[{bool:e.dataplaneInsight.version?.kumaDp?.kumaCpCompatible===!1||e.dataplaneInsight.version?.envoy?.kumaDpCompatible===!1,key:"dp-cp-incompatible"},{bool:e.isCertExpiresSoon,key:"certificate-expires-soon"},{bool:e.isCertExpired,key:"certificate-expired"}].filter(({bool:k})=>k)],k=>(n(),p(c,{key:typeof k},[k.length>0?(n(),_(E,{key:0,name:"warning","data-testid":"warning"},{default:a(()=>[u("ul",null,[(n(!0),p(c,null,v(k,({key:h})=>(n(),p("li",{key:h,"data-testid":`warning-${h}`},s(d(`data-planes.routes.items.warnings.${h}`)),9,ee))),128))])]),_:2},1024)):(n(),p(c,{key:1},[o(s(d("common.collection.none")),1)],64))],64))),128))]),actions:a(({row:e})=>[i(I,null,{default:a(()=>[i(b,{to:{name:"data-plane-detail-view",params:{proxy:e.id}}},{default:a(()=>[o(s(d("common.collection.actions.view")),1)]),_:2},1032,["to"])]),_:2},1024)]),_:2},1032,["headers","items","onResize"]),t[14]||(t[14]=o()),r.params.proxy?(n(),_(R,{key:0},{default:a(e=>[i(N,{onClose:k=>r.replace({name:r.name,params:{mesh:r.params.mesh},query:{page:r.params.page,size:r.params.size}})},{default:a(()=>[typeof f<"u"?(n(),_(J(e.Component),{key:0,items:f.items},null,8,["items"])):w("",!0)]),_:2},1032,["onClose"])]),_:2},1024)):w("",!0)]),_:2},1032,["items","total","page","page-size","onChange"])]),_:2},1032,["src"]))),128))]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:3})}}}),ne=Q(ae,[["__scopeId","data-v-f7c0eb6c"]]);export{ne as default};
