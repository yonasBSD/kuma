import{d as j,r as c,p as g,o,w as e,b as s,e as a,q as b,l as m,c as u,t as i,L as y,M as h,m as A,$ as F,K as D,R as L,I as G,Z,S as J,y as W,_ as H}from"./index-B8sBWiVp.js";const Q={key:0},U={key:1},Y={key:0},ee=["data-testid"],te=j({__name:"MeshServiceDetailView",props:{data:{}},setup(N){const d=N;return(ae,t)=>{const _=c("XBadge"),w=c("XAction"),$=c("KumaPort"),k=c("XLayout"),B=c("XDl"),I=c("XAboutCard"),S=c("XCopyButton"),R=c("DataCollection"),T=c("DataLoader"),C=c("XCard"),x=c("XIcon"),E=c("XSearch"),P=c("XActionGroup"),M=c("XDrawer"),q=c("RouterView"),K=c("AppView"),O=c("RouteView");return o(),g(O,{name:"mesh-service-detail-view",params:{mesh:"",service:"",page:1,size:Number,s:"",proxy:"",codeSearch:"",codeFilter:!1,codeRegExp:!1}},{default:e(({can:X,route:p,t:l,uri:V,me:f})=>[s(K,null,{default:e(()=>[s(k,{type:"stack"},{default:e(()=>[s(I,{title:l("services.mesh-service.about.title"),created:d.data.creationTime,modified:d.data.modificationTime,"data-testid":"mesh-service-about-section"},{default:e(()=>[s(B,{variant:"x-stack"},{default:e(()=>[m("div",null,[m("dt",null,i(l("http.api.property.state")),1),t[1]||(t[1]=a()),m("dd",null,[s(_,{appearance:d.data.spec.state==="Available"?"success":"danger"},{default:e(()=>[a(i(d.data.spec.state),1)]),_:1},8,["appearance"])])]),t[7]||(t[7]=a()),d.data.namespace.length>0?(o(),u("div",Q,[m("dt",null,i(l("http.api.property.namespace")),1),t[2]||(t[2]=a()),m("dd",null,[s(_,{appearance:"decorative"},{default:e(()=>[a(i(d.data.namespace),1)]),_:1})])])):b("",!0),t[8]||(t[8]=a()),X("use zones")&&d.data.zone?(o(),u("div",U,[m("dt",null,i(l("http.api.property.zone")),1),t[3]||(t[3]=a()),m("dd",null,[s(w,{to:{name:"zone-cp-detail-view",params:{zone:d.data.zone}}},{default:e(()=>[s(_,{appearance:"decorative"},{default:e(()=>[a(i(d.data.zone),1)]),_:1})]),_:1},8,["to"])])])):b("",!0),t[9]||(t[9]=a()),m("div",null,[m("dt",null,i(l("http.api.property.ports")),1),t[4]||(t[4]=a()),m("dd",null,[d.data.spec.ports.length?(o(),g(k,{key:0,type:"separated",truncate:""},{default:e(()=>[(o(!0),u(y,null,h(d.data.spec.ports,r=>(o(),g($,{key:r.port,port:{...r,targetPort:void 0}},null,8,["port"]))),128))]),_:1})):(o(),u(y,{key:1},[a(i(l("common.detail.none")),1)],64))])]),t[10]||(t[10]=a()),m("div",null,[m("dt",null,i(l("http.api.property.selector")),1),t[5]||(t[5]=a()),m("dd",null,[Object.keys(d.data.spec.selector.dataplaneTags).length?(o(),g(k,{key:0,type:"separated",truncate:""},{default:e(()=>[(o(!0),u(y,null,h(d.data.spec.selector.dataplaneTags,(r,n)=>(o(),g(_,{key:`${n}:${r}`,appearance:"info"},{default:e(()=>[a(i(n)+":"+i(r),1)]),_:2},1024))),128))]),_:1})):(o(),u(y,{key:1},[a(i(l("common.detail.none")),1)],64))])]),t[11]||(t[11]=a()),(o(!0),u(y,null,h([Object.entries(d.data.labels)],r=>(o(),u(y,{key:typeof r},[r.length>0?(o(),u("div",Y,[m("dt",null,i(l("services.routes.item.labels")),1),t[6]||(t[6]=a()),m("dd",null,[s(k,{variant:"separated",truncate:""},{default:e(()=>[(o(),u(y,null,h([/^(.+\.)?kuma\.io\//],n=>(o(),u(y,{key:typeof n},[(o(!0),u(y,null,h(r,([v,z])=>(o(),g(_,{key:v,appearance:n.test(v)?"info":"decorative"},{default:e(()=>[a(i(v)+":"+i(z),1)]),_:2},1032,["appearance"]))),128))],64))),64))]),_:2},1024)])])):b("",!0)],64))),128))]),_:2},1024)]),_:2},1032,["title","created","modified"]),t[29]||(t[29]=a()),s(C,null,{title:e(()=>[a(i(l("services.detail.hostnames.title")),1)]),default:e(()=>[t[13]||(t[13]=a()),s(T,{src:V(A(F),"/meshes/:mesh/:serviceType/:serviceName/_hostnames",{mesh:p.params.mesh,serviceType:"meshservices",serviceName:p.params.service}),variant:"list"},{default:e(({data:[r]})=>[s(R,{type:"hostnames",items:r.items},{default:e(()=>[s(D,{type:"hostnames-collection","data-testid":"hostnames-collection",items:r.items,headers:[{...f.get("headers.hostname"),label:l("services.detail.hostnames.hostname"),key:"hostname"},{...f.get("headers.zones"),label:l("services.detail.hostnames.zone"),key:"zones"}],onResize:f.set},{hostname:e(({row:n})=>[m("b",null,[s(S,{text:n.hostname},null,8,["text"])])]),zones:e(({row:n})=>[s(k,{type:"separated"},{default:e(()=>[(o(!0),u(y,null,h(n.zones,(v,z)=>(o(),g(_,{key:z,appearance:"decorative"},{default:e(()=>[s(w,{to:{name:"zone-cp-detail-view",params:{zone:v.name}}},{default:e(()=>[a(i(v.name),1)]),_:2},1032,["to"])]),_:2},1024))),128))]),_:2},1024)]),_:1},8,["items","headers","onResize"])]),_:2},1032,["items"])]),_:2},1032,["src"])]),_:2},1024),t[30]||(t[30]=a()),d.data.spec.identities.length?(o(),g(C,{key:0,"data-testid":"mesh-service-identities"},{title:e(()=>[a(i(l("services.detail.identities.title")),1)]),default:e(()=>[t[15]||(t[15]=a()),s(D,{type:"mesh-identities-collection",items:d.data.spec.identities,headers:[{...f.get("headers.identity"),label:l("services.detail.identities.identity"),key:"identity"},{...f.get("headers.type"),label:l("services.detail.identities.type"),key:"type"}],onResize:f.set},{identity:e(({row:r})=>[m("b",null,[s(S,{text:r.value},null,8,["text"])])]),type:e(({row:r})=>[s(k,{type:"separated"},{default:e(()=>[s(_,{appearance:"decorative"},{default:e(()=>[a(i(r.type),1)]),_:2},1024)]),_:2},1024)]),_:1},8,["items","headers","onResize"])]),_:2},1024)):b("",!0),t[31]||(t[31]=a()),s(C,null,{title:e(()=>[a(i(l("services.detail.dpp-status.title")),1)]),default:e(()=>[t[19]||(t[19]=a()),s(k,{type:"columns",class:"columns-with-borders"},{default:e(()=>[s(L,{total:d.data.status.dataplaneProxies.total,online:d.data.status.dataplaneProxies.connected,"data-testid":"connected-dpps"},{icon:e(()=>[s(x,{name:"connected"})]),title:e(()=>[a(i(l("services.detail.dpp-status.connected")),1)]),_:2},1032,["total","online"]),t[18]||(t[18]=a()),s(L,{total:d.data.status.dataplaneProxies.healthy,"data-testid":"healthy-dpps"},{icon:e(()=>[s(x,{name:"healthy"})]),title:e(()=>[a(i(l("services.detail.dpp-status.healthy")),1)]),_:2},1032,["total"])]),_:2},1024)]),_:2},1024),t[32]||(t[32]=a()),m("div",null,[s(C,{class:"mt-4"},{title:e(()=>[a(i(l("services.detail.data_plane_proxies")),1)]),default:e(()=>[t[27]||(t[27]=a()),m("search",null,[m("form",{class:"search-form",onSubmit:t[0]||(t[0]=G(()=>{},["prevent"]))},[s(E,{class:"search-field",keys:["name","tag","label"],value:p.params.s,onChange:r=>p.update({page:1,s:r})},null,8,["value","onChange"])],32)]),t[28]||(t[28]=a()),s(T,{src:V(A(Z),"/meshes/:mesh/dataplanes/for/mesh-service/:tags",{mesh:p.params.mesh,tags:JSON.stringify({...d.data.spec.selector.dataplaneTags})},{page:p.params.page,size:p.params.size,search:`${p.params.s}${X("use zones")&&d.data.zone.length>0?` zone:${d.data.zone}`:""}`}),variant:"list"},{default:e(({data:[r]})=>[s(R,{type:"data-planes",items:r.items,page:p.params.page,"page-size":p.params.size,total:r.total,onChange:p.update},{default:e(()=>[s(D,{class:"data-plane-collection","data-testid":"data-plane-collection",headers:[{...f.get("headers.name"),label:"Name",key:"name"},{...f.get("headers.namespace"),label:"Namespace",key:"namespace"},...X("use zones")?[{...f.get("headers.zone"),label:"Zone",key:"zone"}]:[],{...f.get("headers.certificate"),label:"Certificate info",key:"certificate"},{...f.get("headers.status"),label:"Status",key:"status"},{...f.get("headers.warnings"),label:"Warnings",key:"warnings",hideLabel:!0},{...f.get("headers.actions"),label:"Actions",key:"actions",hideLabel:!0}],items:r.items,"is-selected-row":n=>n.name===p.params.proxy,onResize:f.set},{name:e(({row:n})=>[s(w,{class:"name-link",to:{name:"mesh-service-data-plane-summary-view",params:{mesh:n.mesh,proxy:n.id},query:{page:p.params.page,size:p.params.size,s:p.params.s}},"data-action":""},{default:e(()=>[a(i(n.name),1)]),_:2},1032,["to"])]),namespace:e(({row:n})=>[a(i(n.namespace),1)]),zone:e(({row:n})=>[n.zone?(o(),g(w,{key:0,to:{name:"zone-cp-detail-view",params:{zone:n.zone}}},{default:e(()=>[a(i(n.zone),1)]),_:2},1032,["to"])):(o(),u(y,{key:1},[a(i(l("common.collection.none")),1)],64))]),certificate:e(({row:n})=>[n.dataplaneInsight.mTLS?.certificateExpirationTime?(o(),u(y,{key:0},[a(i(l("common.formats.datetime",{value:Date.parse(n.dataplaneInsight.mTLS.certificateExpirationTime)})),1)],64)):(o(),u(y,{key:1},[a(i(l("data-planes.components.data-plane-list.certificate.none")),1)],64))]),status:e(({row:n})=>[s(J,{status:n.status},null,8,["status"])]),warnings:e(({row:n})=>[(o(!0),u(y,null,h([[{bool:n.dataplaneInsight.version?.kumaDp?.kumaCpCompatible===!1||n.dataplaneInsight.version?.envoy?.kumaDpCompatible===!1,key:"dp-cp-incompatible"},{bool:n.isCertExpiresSoon,key:"certificate-expires-soon"},{bool:n.isCertExpired,key:"certificate-expired"}].filter(({bool:v})=>v)],v=>(o(),u(y,{key:typeof v},[v.length>0?(o(),g(x,{key:0,name:"warning","data-testid":"warning"},{default:e(()=>[m("ul",null,[(o(!0),u(y,null,h(v,({key:z})=>(o(),u("li",{key:z,"data-testid":`warning-${z}`},i(l(`data-planes.routes.items.warnings.${z}`)),9,ee))),128))])]),_:2},1024)):(o(),u(y,{key:1},[a(i(l("common.collection.none")),1)],64))],64))),128))]),actions:e(({row:n})=>[s(P,null,{default:e(()=>[s(w,{to:{name:"data-plane-detail-view",params:{proxy:n.id}}},{default:e(()=>[a(i(l("common.collection.actions.view")),1)]),_:2},1032,["to"])]),_:2},1024)]),_:2},1032,["headers","items","is-selected-row","onResize"]),t[26]||(t[26]=a()),p.params.proxy?(o(),g(q,{key:0},{default:e(n=>[s(M,{onClose:v=>p.replace({name:p.name,params:{mesh:p.params.mesh},query:{page:p.params.page,size:p.params.size,s:p.params.s}})},{default:e(()=>[typeof r<"u"?(o(),g(W(n.Component),{key:0,items:r.items},null,8,["items"])):b("",!0)]),_:2},1032,["onClose"])]),_:2},1024)):b("",!0)]),_:2},1032,["items","page","page-size","total","onChange"])]),_:2},1032,["src"])]),_:2},1024)])]),_:2},1024)]),_:2},1024)]),_:1})}}}),ne=H(te,[["__scopeId","data-v-c4b6e3d2"]]);export{ne as default};
