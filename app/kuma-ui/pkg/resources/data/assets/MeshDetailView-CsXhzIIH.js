import{d as W,r as m,p as u,o,w as e,b as s,e as a,m as k,H as G,P,q as b,c as p,l as y,L as h,M as _,t as r,K as Z,R as X,N as j,F as ee,Y as q,y as te,_ as se}from"./index-D9fsUKAU.js";const ae={"data-testid":"mesh-mtls"},ne={key:0},oe=W({__name:"MeshDetailView",props:{mesh:{}},setup(N){const c=N;return(ie,t)=>{const z=m("RouteTitle"),M=m("XI18n"),A=m("XNotification"),S=m("XAction"),v=m("XBadge"),g=m("XLayout"),E=m("XDl"),F=m("XAboutCard"),I=m("DataCollection"),L=m("XCard"),O=m("XIcon"),V=m("DataSource"),Y=m("XSelect"),T=m("XCodeBlock"),$=m("DataLoader"),H=m("XDrawer"),K=m("RouterView"),J=m("AppView"),Q=m("RouteView");return o(),u(Q,{name:"mesh-detail-view",params:{mesh:"",environment:String}},{default:e(({route:d,t:l,uri:C,me:x})=>[s(z,{title:l("meshes.routes.overview.title"),render:!1},null,8,["title"]),t[22]||(t[22]=a()),s(V,{src:C(k(G),"/mesh-insights/:name",{name:d.params.mesh})},{default:e(({data:f})=>[s(V,{src:C(k(P),"/meshes/:mesh/meshidentities",{mesh:d.params.mesh})},{default:e(({data:D})=>[s(V,{src:C(k(P),"/meshes/:mesh/meshtrusts",{mesh:d.params.mesh})},{default:e(({data:B})=>[s(J,{docs:l("meshes.href.docs"),notifications:!0},{default:e(()=>[s($,{data:[D,B]},{default:e(()=>[s(A,{notify:!c.mesh.mtlsBackend&&D.items.length===0,uri:`meshes.notifications.mtls-warning:${c.mesh.id}`},{default:e(()=>[s(M,{path:"meshes.notifications.mtls-warning"})]),_:1},8,["notify","uri"]),t[19]||(t[19]=a()),s(A,{notify:N.mesh.meshServices.mode==="Disabled",uri:`meshes.notifications.mesh-service-activation:${d.params.mesh}`,variant:"info"},{default:e(()=>[s(M,{path:"meshes.notifications.mesh-service-activation"})]),_:1},8,["notify","uri"]),t[20]||(t[20]=a()),s(g,{type:"stack"},{default:e(()=>[s(F,{title:l("meshes.routes.item.about.title"),created:c.mesh.creationTime,modified:c.mesh.modificationTime,class:"about-section","data-testid":"mesh-about-section"},{default:e(()=>[s(E,{variant:"x-stack"},{default:e(()=>[(o(),p(h,null,_(["MeshTrafficPermission","MeshMetric","MeshAccessLog","MeshTrace"],n=>(o(),p(h,{key:n},[(o(!0),p(h,null,_([f?.policies?.[n]??{total:0}],i=>(o(),p(h,{key:typeof i},[s(A,{notify:n==="MeshTrafficPermission"&&c.mesh.mtlsBackend&&i.total===0,uri:`meshes.notifications.mtp-warning:${c.mesh.id}`},{default:e(()=>[s(M,{path:"meshes.notifications.mtp-warning"})]),_:1},8,["notify","uri"]),t[1]||(t[1]=a()),y("div",null,[y("dt",null,[s(S,{to:{name:"policy-list-view",params:{mesh:d.params.mesh,policyPath:`${n.toLowerCase()}s`}}},{default:e(()=>[a(r(n),1)]),_:2},1032,["to"])]),t[0]||(t[0]=a()),y("dd",null,[s(v,{appearance:i.total>0?"success":"neutral"},{default:e(()=>[a(r(i.total>0?l("meshes.detail.enabled"):l("meshes.detail.disabled")),1)]),_:2},1032,["appearance"])])])],64))),128))],64))),64)),t[6]||(t[6]=a()),y("div",ae,[y("dt",null,r(l("http.api.property.mtls")),1),t[4]||(t[4]=a()),y("dd",null,[s(g,{type:"separated"},{default:e(()=>[c.mesh.mtlsBackend?(o(),u(v,{key:0,appearance:"info"},{default:e(()=>[a(r(c.mesh.mtlsBackend.type)+" / "+r(c.mesh.mtlsBackend.name),1)]),_:1})):b("",!0),t[2]||(t[2]=a()),(o(!0),p(h,null,_(D?.items,n=>(o(),u(S,{key:n.name,to:{name:"mesh-identity-summary-view",params:{mid:n.kri}}},{default:e(()=>[s(v,{appearance:"info"},{default:e(()=>[a(`
                                MeshIdentity / `+r(n.name),1)]),_:2},1024)]),_:2},1032,["to"]))),128)),t[3]||(t[3]=a()),!c.mesh.mtlsBackend&&!D?.items?.length?(o(),u(v,{key:1,appearance:"neutral"},{default:e(()=>[a(r(l("meshes.detail.disabled")),1)]),_:2},1024)):b("",!0)]),_:2},1024)])]),t[7]||(t[7]=a()),(o(!0),p(h,null,_([Object.entries(c.mesh.labels)],n=>(o(),p(h,{key:typeof n},[n.length>0?(o(),p("div",ne,[y("dt",null,r(l("services.routes.item.labels")),1),t[5]||(t[5]=a()),y("dd",null,[s(g,{variant:"separated",truncate:""},{default:e(()=>[(o(),p(h,null,_([/^(.+\.)?kuma\.io\//],i=>(o(),p(h,{key:typeof i},[(o(!0),p(h,null,_(n,([w,R])=>(o(),u(v,{key:w,appearance:i.test(w)?"info":"decorative"},{default:e(()=>[a(r(w)+":"+r(R),1)]),_:2},1032,["appearance"]))),128))],64))),64))]),_:2},1024)])])):b("",!0)],64))),128))]),_:2},1024)]),_:2},1032,["title","created","modified"]),t[16]||(t[16]=a()),B?.items?.length?(o(),u(L,{key:0,"data-testid":"mesh-trusts-listing"},{title:e(()=>[a(r(l("meshes.routes.item.mesh-trusts.title")),1)]),default:e(()=>[t[10]||(t[10]=a()),s(I,{type:"mesh-trusts",items:B?.items},{default:e(()=>[s(Z,{type:"mesh-trusts-collection",items:B?.items,headers:[{...x.get("headers.identity"),label:l("meshes.routes.item.mesh-trusts.name"),key:"name"},{...x.get("headers.type"),label:l("meshes.routes.item.mesh-trusts.trust-domain"),key:"trustDomain"},{...x.get("headers.origin"),label:l("meshes.routes.item.mesh-trusts.origin"),key:"origin"}],onResize:x.set},{name:e(({row:n})=>[s(S,{class:"name-link",title:n.name,to:{name:"mesh-trust-summary-view",params:{mtrust:n.kri},query:{environment:d.params.environment}},"data-action":""},{default:e(()=>[y("b",null,r(n.name),1)]),_:2},1032,["title","to"])]),trustDomain:e(({row:n})=>[s(v,{appearance:"decorative"},{default:e(()=>[a(r(n.spec.trustDomain),1)]),_:2},1024)]),origin:e(({row:n})=>[n.spec.origin.kri.length>0?(o(),u(S,{key:0,to:{name:"mesh-identity-summary-view",params:{mid:n.spec.origin.kri}},"data-action":""},{default:e(()=>[s(v,{appearance:"decorative"},{default:e(()=>[a(r(n.spec.origin.kri),1)]),_:2},1024)]),_:2},1032,["to"])):b("",!0)]),_:2},1032,["items","headers","onResize"])]),_:2},1032,["items"])]),_:2},1024)):b("",!0),t[17]||(t[17]=a()),s(L,null,{default:e(()=>[s(g,{type:"columns",class:"columns-with-borders"},{default:e(()=>[c.mesh.meshServices.mode==="Exclusive"?(o(),u(X,{key:0,total:f?.resources.MeshServiceGeneric.total??0,"data-testid":"services-status"},{title:e(()=>[a(r(l("meshes.detail.services")),1)]),_:2},1032,["total"])):c.mesh.meshServices.mode==="Disabled"?(o(),u(X,{key:1,total:f?.services.total??0,"data-testid":"services-status"},{title:e(()=>[a(r(l("meshes.detail.services")),1)]),_:2},1032,["total"])):(o(),u(X,{key:2,total:f?.resources.MeshServiceGeneric.total??0,"data-testid":"mesh-services-status"},j({title:e(()=>[a(r(l("meshes.detail.services")),1)]),_:2},[f?.resources.MeshServiceGeneric.total&&f?.services.total>0?{name:"description",fn:e(()=>[a(r(l("meshes.detail.mesh_services")),1)]),key:"0"}:void 0,f?.resources.MeshServiceGeneric.total&&f?.services.total>0?{name:"body",fn:e(()=>[s(X,{total:f?.services.total??0,"data-testid":"services-status"},{description:e(()=>[a(r(l("meshes.detail.services"))+" ",1),s(O,{name:"info"},{default:e(()=>[s(M,{path:"meshes.detail.infos.services"})]),_:1})]),_:2},1032,["total"])]),key:"1"}:void 0]),1032,["total"])),t[13]||(t[13]=a()),s(X,{total:f?.dataplanesByType.standard.total??0,online:f?.dataplanesByType.standard.online??0,"data-testid":"data-plane-proxies-status"},{title:e(()=>[a(r(l("meshes.detail.data_plane_proxies")),1)]),_:2},1032,["total","online"]),t[14]||(t[14]=a()),s(V,{src:C(k(ee),"/policy-types",{})},{default:e(({data:n})=>[(o(!0),p(h,null,_([n?.policyTypes.map(i=>i.name)],i=>(o(),u(X,{key:typeof i,total:Object.entries(f?.resources||{}).reduce((w,[R,{total:U}])=>(i||[]).includes(R)?w+U:w,0),"data-testid":"policies-status"},{title:e(()=>[a(r(l("meshes.detail.policies")),1)]),_:2},1032,["total"]))),128))]),_:2},1032,["src"])]),_:2},1024)]),_:2},1024),t[18]||(t[18]=a()),s(L,null,{default:e(()=>[s(g,null,{default:e(()=>[s(g,{type:"separated",justify:"end"},{default:e(()=>[(o(),p(h,null,_([["universal","k8s"]],n=>y("div",{key:typeof n},[s(Y,{label:l("meshes.routes.item.format"),selected:d.params.environment,onChange:i=>{d.update({environment:i})},onVnodeBeforeMount:i=>i?.props?.selected&&n.includes(i.props.selected)&&i.props.selected!==d.params.environment&&d.update({environment:i.props.selected})},j({_:2},[_(n,i=>({name:`${i}-option`,fn:e(()=>[a(r(l(`meshes.routes.item.formats.${i}`)),1)])}))]),1032,["label","selected","onChange","onVnodeBeforeMount"])])),64))]),_:2},1024),t[15]||(t[15]=a()),d.params.environment==="universal"?(o(),u(T,{key:0,"data-testid":"codeblock-yaml-universal",language:"yaml",code:k(q).stringify(c.mesh.config)},null,8,["code"])):(o(),u($,{key:1,src:C(k(G),"/meshes/:name/as/kubernetes",{name:d.params.mesh})},{default:e(({data:n})=>[s(T,{"data-testid":"codeblock-yaml-k8s",language:"yaml",code:k(q).stringify(n)},null,8,["code"])]),_:1},8,["src"]))]),_:2},1024)]),_:2},1024)]),_:2},1024),t[21]||(t[21]=a()),s(K,null,{default:e(n=>[n.route.name!==d.name?(o(),u(H,{key:0,onClose:i=>d.replace({name:"mesh-detail-view",params:{mesh:d.params.mesh},query:{environment:d.params.environment}})},{default:e(()=>[(o(),u(te(n.Component),{"mesh-identities":D?.items,"mesh-trusts":B?.items},null,8,["mesh-identities","mesh-trusts"]))]),_:2},1032,["onClose"])):b("",!0)]),_:2},1024)]),_:2},1032,["data"])]),_:2},1032,["docs"])]),_:2},1032,["src"])]),_:2},1032,["src"])]),_:2},1032,["src"])]),_:1})}}}),le=se(oe,[["__scopeId","data-v-900fdece"]]);export{le as default};
